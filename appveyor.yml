version: 0.0.1.{build}

platform: x64

branches:
    only:
        - master

clone_folder: c:\gopath\src\github.com\andreas-jonsson\fantasim-pub

environment:
    GOPATH: c:\gopath

install:
    - appveyor DownloadFile https://storage.googleapis.com/golang/go1.9.3.windows-amd64.msi
    - msiexec /i go1.9.3.windows-amd64.msi /q
    - go version
    - go env

    # - set PATH="c:\Program Files (x86)\Inno Setup 5";%PATH%

build_script:
    - cd frontends\sdl
    - go get github.com/akavel/rsrc
    # - rsrc -ico=icon.ico -arch=amd64
    - go get -v 
    # - go build
    - go build -o fantasim-sdl.exe -ldflags="-H windowsgui"

after_build:
    - cd frontends\sdl
    # - iscc /Qp /O".\" /Ffantasim-sdl-%APPVEYOR_BUILD_VERSION%-win64 setup.iss
    - iscc /Qp /O".\" frontends\sdl\setup.iss

artifacts:
    - path: fantasim-sdl-setup.exe
